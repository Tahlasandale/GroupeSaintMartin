{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user account within the AuthZen application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "User's display name."
        },
        "signUpDate": {
          "type": "string",
          "description": "The date and time the user signed up.",
          "format": "date-time"
        },
        "lastLogin": {
          "type": "string",
          "description": "The date and time the user last logged in.",
          "format": "date-time"
        },
        "googleId": {
          "type": "string",
          "description": "User's google ID, if they signed up using google."
        },
        "isAdmin": {
          "type": "boolean",
          "description": "Indicates if the user has administrative privileges."
        }
      },
      "required": [
        "id",
        "email",
        "signUpDate"
      ]
    },
    "Dashboard": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Dashboard",
      "type": "object",
      "description": "Represents a dashboard page for a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the Dashboard entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:1 Dashboard)"
        },
        "title": {
          "type": "string",
          "description": "Title of the dashboard."
        },
        "description": {
          "type": "string",
          "description": "Description of the dashboard."
        },
        "createdDate": {
          "type": "string",
          "description": "The date and time the dashboard was created.",
          "format": "date-time"
        },
        "lastUpdated": {
          "type": "string",
          "description": "The date and time the dashboard was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "title",
        "createdDate"
      ]
    },
    "PreRegistration": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "PreRegistration",
      "type": "object",
      "description": "Represents an email submitted through the pre-registration form.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the PreRegistration entity."
        },
        "email": {
          "type": "string",
          "description": "Email address submitted for pre-registration.",
          "format": "email"
        },
        "createdAt": {
          "type": "string",
          "description": "The date and time the email was submitted.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "email",
        "createdAt"
      ]
    },
    "ContactSubmission": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ContactSubmission",
      "type": "object",
      "description": "Represents a submission from the contact form.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ContactSubmission entity."
        },
        "fullName": {
          "type": "string",
          "description": "Full name of the person submitting the form."
        },
        "email": {
          "type": "string",
          "description": "Email address of the person submitting the form.",
          "format": "email"
        },
        "message": {
          "type": "string",
          "description": "The message content."
        },
        "createdAt": {
          "type": "string",
          "description": "The date and time the message was submitted.",
          "format": "date-time"
        },
        "read": {
          "type": "boolean",
          "description": "Indicates if the contact message has been read."
        },
        "processed": {
          "type": "boolean",
          "description": "Indicates if the contact message has been processed."
        }
      },
      "required": [
        "fullName",
        "email",
        "message",
        "createdAt"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile data. The 'userId' parameter corresponds to the Firebase Auth UID. This allows path-based ownership, simplifying security rules.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Auth UID of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/dashboards/{dashboardId}",
        "definition": {
          "entityName": "Dashboard",
          "schema": {
            "$ref": "#/backend/entities/Dashboard"
          },
          "description": "Stores dashboards owned by a user. The 'userId' parameter corresponds to the Firebase Auth UID, and the 'dashboardId' is a unique identifier for the dashboard. This enables path-based ownership and simplifies security rules.",
          "params": [
            {
              "name": "userId",
              "description": "The Firebase Auth UID of the user."
            },
            {
              "name": "dashboardId",
              "description": "Unique identifier for the dashboard."
            }
          ]
        }
      },
      {
        "path": "/pre-registrations/{preRegistrationId}",
        "definition": {
          "entityName": "PreRegistration",
          "schema": {
            "$ref": "#/backend/entities/PreRegistration"
          },
          "description": "Stores emails from the pre-registration form. This collection is write-only for the public and not readable to protect privacy.",
          "params": [
            {
              "name": "preRegistrationId",
              "description": "Unique identifier for the pre-registration entry."
            }
          ]
        }
      },
      {
        "path": "/contact-submissions/{submissionId}",
        "definition": {
          "entityName": "ContactSubmission",
          "schema": {
            "$ref": "#/backend/entities/ContactSubmission"
          },
          "description": "Stores submissions from the public contact form. This collection is write-only for the public.",
          "params": [
            {
              "name": "submissionId",
              "description": "Unique identifier for the contact submission."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed to securely manage user data and dashboards. The `/users/{userId}` collection stores user profiles, while the `/users/{userId}/dashboards/{dashboardId}` subcollection stores dashboards owned by each user. This structure uses path-based ownership, ensuring strong data isolation and simplified security rules. The `/pre-registrations` and `/contact-submissions` collections are designed for public write access, with read access disabled to ensure privacy and security. Authorization Independence is achieved because access control is directly tied to the path and the user's authentication status. List operations are secure due to the hierarchical structure; a user can only list dashboards within their own user document. Because of this data segregation and strict user ownership, QAPs are directly supported by the path structure."
  }
}
